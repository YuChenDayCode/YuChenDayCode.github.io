---
title: .NET Windows服务发布、安装、卸载、监听脚本。服务调试
date: 2018/11/22 15:24
tags: .NET、Window服务
---

**一、脚本**

  为方便不用每次都去写安装卸载的脚本



1.安装脚本



```
@echo off
@echo 开始安装【服务】
%SystemRoot%\Microsoft.NET\Framework64\v4.0.30319\installutil.exe %~dp0服务名.exe
 
pause
```



2.卸载脚本



```bash
@echo off
@echo 开始卸载 
%SystemRoot%\Microsoft.NET\Framework64\v4.0.30319\installutil.exe /u %~dp0服务名.exe
pause
```

%~dp0:脚本所在目录



 



3.监听脚本（停止了自动启动）



```bash
@echo off
 
set ServiceName="服务名"
set flag=0
::echo "%%a%%b" == %ServiceName% 
for /f "tokens=1* delims= " %%a in ('net start') do if "%%a%%b"== %ServiceName%  set flag=1
if %flag%==0 (net start %ServiceName%
)else (@echo 服务正在运行)
```





注：

​    所有安装卸载脚本需放在服务同目录下，监听脚本任意 所有脚本都是bat脚本，需用管理员权限执行

​    监听脚本可以用windows自带的任务计划设置每几分钟或小时运行一次 就可以达到监听的目的

​    注意安装卸载路径 %SystemRoot%\Microsoft.NET\Framework64\v4.0.30319\installutil.exe，如果不是生成的64位程序Framework64需去掉64



**二、调试**

  如需调试服务 可在服务启动函数中加上：**Debugger.Launch()**; 启动服务后附加到vs中就可以调试了